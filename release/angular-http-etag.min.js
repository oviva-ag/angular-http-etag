!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("angular")):"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?exports["http-etag"]=t(require("angular")):e["http-etag"]=t(e.angular)}(window,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(t,n){t.exports=e},function(e,t){e.exports=function(e,t){if(e.map)return e.map(t);for(var r=[],o=0;o<e.length;o++){var c=e[o];n.call(e,o)&&r.push(t(c,o,e))}return r};var n=Object.prototype.hasOwnProperty},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,c=Array.prototype.slice,a=n(3),i=Object.prototype.propertyIsEnumerable,u=!i.call({toString:null},"toString"),f=i.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(e){var t=e.constructor;return t&&t.prototype===e},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},l=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!h["$"+e]&&r.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{p(window[e])}catch(e){return!0}}catch(e){return!0}return!1}(),d=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===o.call(e),c=a(e),i=t&&"[object String]"===o.call(e),h=[];if(!t&&!n&&!c)throw new TypeError("Object.keys called on a non-object");var d=f&&n;if(i&&e.length>0&&!r.call(e,0))for(var m=0;m<e.length;++m)h.push(String(m));if(c&&e.length>0)for(var g=0;g<e.length;++g)h.push(String(g));else for(var v in e)d&&"prototype"===v||!r.call(e,v)||h.push(String(v));if(u)for(var y=function(e){if("undefined"==typeof window||!l)return p(e);try{return p(e)}catch(e){return!1}}(e),I=0;I<s.length;++I)y&&"constructor"===s[I]||!r.call(e,s[I])||h.push(s[I]);return h};d.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var e=Object.keys;Object.keys=function(t){return a(t)?e(c.call(t)):e(t)}}}else Object.keys=d;return Object.keys||d},e.exports=d},function(e,t,n){"use strict";var r=Object.prototype.toString;e.exports=function(e){var t=r.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===r.call(e.callee)),n}},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=function(){var e=this,t=["createCache","getCache"],n=["setItem","getItem","removeItem","removeAllItems"],r=t.concat(n),c={},a={},i="httpEtagCache",u={cacheResponseData:!0,cacheService:"$cacheFactory",cacheOptions:{number:128}};e.setDefaultCacheConfig=function(t){return u=o.a.extend({},u,t),e},e.getDefaultCacheConfig=function(){return u},e.defineCache=function(t,n){return n=o.a.extend({},u,n,{id:t}),a[t]=n,e},e.defineCacheServiceAdapter=function(t,n){if(!n)throw new Error("Missing cache service adapter configuration");if(!n.methods)throw new Error("Missing cache service adapter configuration methods");return o.a.forEach(r,function(e){if("function"!=typeof n.methods[e])throw new Error('Expected cache service adapter method "'+e+'" to be a function')}),c[t]=n,e},e.getCacheServiceAdapter=function(e){return c[e]},e.$get=["$injector",function(r){var u={},f={},s={},p={},h={};return a[i]||e.defineCache(i),o.a.forEach(c,function(e,n){var c=f[n]=window[n]||r.get(n),a=s[n]={};o.a.forEach(t,function(t){a[t]=o.a.bind({},e.methods[t],c)})}),o.a.forEach(a,function(e,t){s[e.cacheService].createCache(t,e);var r=p[t]=s[e.cacheService].getCache(t),i=h[t]={},f=function(e){return e};o.a.forEach(n,function(t){var n,a,u=c[e.cacheService].methods[t];"getItem"===t&&(n=function(e,t,n){var r=u(e,t,n);return r&&f(r.responseData)},a=function(e,t,n){return f(u(e,t,n))}),"setItem"===t&&(n=function(e,t,n,r){var o=i.$getItem(t);n=f(n),o&&"object"==typeof o?(o.responseData=n,n=o):n={responseData:n},u(e,t,n,r)},a=function(e,t,n,r){u(e,t,f(n),r)}),i[t]=o.a.bind({},n||u,r),a&&(i["$"+t]=o.a.bind({},a,r))}),i.unsetItem=function(e){i.setItem(e,void 0)},i.expireItem=function(e){var t=i.$getItem(e);delete t.etagHeader,i.$setItem(e,t)},i.getItemCache=function(e){return u.getItemCache(t,e)},i.info=function(){return a[t]},i.isCache=!0}),u.info=function(){return a},u.getCache=function(e){var t=h[function(e){var t=typeof e;return"number"===t||"string"===t&&e?e:i}(e)];if(t)return t},u.getItemCache=function(e,t){var n=u.getCache(e),r={};if(n){return o.a.forEach([["set","setItem"],["get","getItem"],["$set","$setItem"],["$get","$getItem"],["unset","unsetItem"],["expire","expireItem"],["remove","removeItem"]],function(e){r[e[0]]=o.a.bind({},n[e[1]],t)}),r.info=function(){var e=n.info();return e.itemKey=t,e},r.isItemCache=!0,r}},u.purgeCaches=function(){o.a.forEach(h,function(e){e.removeAllItems()})},u}]};var a=n(2),i=n.n(a),u=n(1),f=n.n(u),s=p;function p(e,t){var n=e,r=["GET","JSONP"];function c(e){var c,i=p.useLegacyPromiseExtensions(),u=!!e.etagCache,f=r.indexOf(e.method)>=0;if(u&&f){var s=function(e){var t=e.etagCache,n=typeof t,r={};"function"===n&&(t=t(e),n=typeof t);if("object"===n){var o,c;t.isCache?(o=t.info().id,c=a(e)):t.isItemCache?(o=t.info().id,c=t.info().itemKey):(o=t.id,c=t.itemKey||a(e)),r.id=o,r.itemKey=c}else if("string"===n)r.id=t,r.itemKey=a(e);else{if(!0!==t)return;r.itemKey=a(e)}return r}(e);if(s){var h=t.getItemCache(s.id,s.itemKey);if(!h)throw new Error("No defined ETag caches match specified cache ID");var l=h.info(),d=h.$get(),m=d&&d.etagHeader,g=m&&d.responseData;e.$$_itemCache=h,m&&(e.headers=o.a.extend({},e.headers,{"If-None-Match":m}))}}return function t(n){var r=n.then;var o=n.success;n.cached=i?function(t){return d&&l.cacheResponseData&&t(g,"cached",void 0,e,h),n}:function(){throw new Error("The method `cached` on the promise returned from `$http` has been disabled in favor of `ifCached`.")};n.ifCached=function(t){return d&&l.cacheResponseData&&t({data:g,status:"cached",headers:void 0,config:e},h),n};n.then=function(e,o,c){var a=r.apply(n,[e?function(t){return e(t,h)}:void 0,o?function(e){return o(e,h)}:void 0,c]);return t(a)};i&&h&&(n.success=function(e){var t=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){for(var n=0,r=0;r<t.length&&n<arguments.length;r++)void 0===t[r]&&(t[r]=arguments[n++]);return e.apply(this,t)}}(e,void 0,void 0,void 0,void 0,h);return o.apply(n,[t])});return n}(c=n.apply(n,arguments)),c}function a(e){var t=e.url,n=function(e){return e?f()(i()(e).sort(),function(t){var n=e[t];return o.a.isArray(n)?f()(n.sort(),function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):encodeURIComponent(t)+"="+encodeURIComponent(n)}).join("&"):""}(e.params),r=n&&t.indexOf("?")>0?"&":"?";return t+(n&&r+n||"")}return o.a.forEach(r,function(e){c[e.toLowerCase()]=function(t,r){return r=o.a.extend({},r,{method:e,url:t}),c.call(n,r)}}),o.a.forEach(n,function(e,t){c[t]||(c[t]=e)}),c}p.$inject=["$delegate","httpEtag"];var h=function(){return{response:function(e){var t=e.config.$$_itemCache;if(t){var n=t.info(),r=n.cacheResponseData,o=e.headers().etag,c={};o&&(c.etagHeader=o,r&&(c.responseData=e.data),t.$set(c)),delete e.config.$$_itemCache}return e}}};var l=d;function d(e){e.defineCacheServiceAdapter("$cacheFactory",{config:{storesDeepCopies:!1},methods:{createCache:function(e,t,n){e(t,n)},getCache:function(e,t){return e.get(t)},setItem:function(e,t,n){e.put(t,n)},getItem:function(e,t){return e.get(t)},removeItem:function(e,t){e.remove(t)},removeAllItems:function(e,t){e.removeAll()}}}).defineCacheServiceAdapter("localStorage",{config:{storesDeepCopies:!0},methods:{createCache:o.a.noop,getCache:function(e,t){return t},setItem:function(e,t,n){try{t=e+":"+t,localStorage.setItem(t,JSON.stringify(n))}catch(e){}},getItem:function(e,t){return t=e+":"+t,JSON.parse(localStorage.getItem(t))},removeItem:function(e,t){t=e+":"+t,localStorage.removeItem(t)},removeAllItems:function(e,t){var n=e+":";o.a.forEach(localStorage,function(e,t){0===t.indexOf(n)&&localStorage.removeItem(t)})}}}).defineCacheServiceAdapter("sessionStorage",{config:{storesDeepCopies:!0},methods:{createCache:o.a.noop,getCache:function(e,t){return t},setItem:function(e,t,n){try{t=e+":"+t,sessionStorage.setItem(t,JSON.stringify(n))}catch(e){}},getItem:function(e,t){return t=e+":"+t,JSON.parse(sessionStorage.getItem(t))},removeItem:function(e,t){t=e+":"+t,sessionStorage.removeItem(t)},removeAllItems:function(e,t){var n=e+":";o.a.forEach(sessionStorage,function(e,t){0===t.indexOf(n)&&sessionStorage.removeItem(t)})}}})}d.$inject=["httpEtagProvider"];t.default=o.a.module("http-etag",[]).provider("httpEtag",c).config(l).config(["$provide","$httpProvider",function(e,t){s.useLegacyPromiseExtensions=t.useLegacyPromiseExtensions||function(){return 1===o.a.version.major&&o.a.version.minor<6},e.decorator("$http",s),t.interceptors.push(h)}]).name}])});
//# sourceMappingURL=angular-http-etag.min.js.map